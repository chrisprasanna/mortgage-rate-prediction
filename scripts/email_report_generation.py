import os
import pandas as pd
from datetime import datetime

def generate_email_report():
    # Read evaluation metrics
    metrics_df = pd.read_csv('results/evaluation_metrics.csv')
    
    # Create HTML report
    html_content = f"""
    <html>
    <body>
    <h1>Mortgage Rate Prediction Report</h1>
    <p>Generated on: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}</p>
    
    <h2>Model Performance Metrics</h2>
    {metrics_df.to_html()}
    
    <h2>Visualizations</h2>
    <h3>Actual vs Predicted Values</h3>
    <img src="cid:actual_vs_predicted.png" width="600">
    
    <h3>Residuals Analysis</h3>
    <img src="cid:residuals.png" width="600">
    
    <h3>Feature Importance</h3>
    <img src="cid:feature_importance.png" width="600">
    
    <p>This is an automated report generated by the mortgage rate prediction pipeline.</p>
    </body>
    </html>
    """
    
    # Save HTML report
    with open('email_report.html', 'w') as f:
        f.write(html_content)

if __name__ == "__main__":
    generate_email_report()